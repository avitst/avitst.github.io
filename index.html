<!DOCTYPE html>
<html>
    <head>
        <title>VoxTest</title>
        <script type="text/javascript" src="https://cdn.voximplant.com/edge/voximplant.min.js"></script>
    </head>
<body>
    <p id="status">This is the status bar.</p>
    <input id="number" type="text" value="+79952340701">
    <br>
    <button id="startcall" onclick="startcall()">Call</button> 
    <button id="endcall" style="display: none;">End call</button> 

    <script>
// get instance
const sdk = VoxImplant.getInstance();

// initialize and log in
const login = async () => {
    try {
        await sdk.init();
            document.getElementById("status").innerHTML = "SDK is ready!";
        try {
            await sdk.connect();
            document.getElementById("status").innerHTML = "Connected!";
        } catch (e) {
            document.getElementById("status").innerHTML = "Connection failed!";
        }
        try {
            await sdk.login("avi@ios.avicus.n4.voximplant.com","excellent");
            document.getElementById("status").innerHTML = "Logged in!";
        } catch (e) {
            document.getElementById("status").innerHTML = "Login failure!";
        }
    } catch (e) {
        document.getElementById("status").innerHTML = "SDK init failure!";
    }
};

login();

// make a call

const startcall = () => {
    // prepare settings
    const callSettings = {
        number: document.getElementById("number").value,
        videoFlags: {
            sendVideo: false,
            receiveVideo: false
        }
    };
    // start the call
    const call = sdk.call(callSettings);
    document.getElementById("startcall").style.display = "none";
    document.getElementById("status").innerHTML = "Calling!";
    // subscribe to the events
    call.addEventListener(VoxImplant.CallEvents.Connected, () => {
        document.getElementById("status").innerHTML = "Call connected!";
        document.getElementById("endcall").style.display = "block";
        document.getElementById("endcall").onclick = () => {
            call.hangup();
        };
    });

    call.addEventListener(VoxImplant.CallEvents.Disconnected, () => {
        document.getElementById("status").innerHTML = "Call disconnected!";
        document.getElementById("startcall").style.display = "block";
        document.getElementById("endcall").style.display = "none";
    });

    call.addEventListener(VoxImplant.CallEvents.Failed, (e) => {
        document.getElementById("status").innerHTML = "Call failed!";
    });
};

    </script>
</body>
</html>